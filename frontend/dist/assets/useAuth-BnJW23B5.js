import{an as f,a8 as u,ao as d}from"./index-QOySC_5N.js";function h(){const s=f(),a=u(!1),r=u(null),n=()=>{r.value=null};return{register:async(l,o)=>{a.value=!0,n();try{const e={username:l,password:o.slice(0,72)};return(await d.post("/register",e)).data}catch(e){throw r.value=e.response?.data?.detail||e.message||"Registration failed",e}finally{a.value=!1}},login:async(l,o)=>{a.value=!0,n();try{const e={username:l,password:o.slice(0,72)},t=await d.post("/login",e),i=t.data?.access_token??t.data?.token??null,c=t.data?.user??null;return i&&s.setToken(i),c?s.setUser(c):await s.fetchMe(),t.data}catch(e){throw r.value=e.response?.data?.detail||e.message||"Login failed",e}finally{a.value=!1}},me:async()=>{a.value=!0,n();try{return await s.fetchMe()}finally{a.value=!1}},loading:a,error:r,clearError:n}}export{h as u};
