import{a5 as K,a8 as u,ag as ee,c as p,a as e,_ as T,N as g,ab as ie,Q as f,F as X,j as Y,a2 as re,o as d,O as G,ac as ke,ae as W,a7 as J,a9 as se,aa as ae,i as H,k as P,U as te,V as oe,ah as ne,Z as le,ai as de,K as ue,aj as ce,ak as pe,al as me,h as he,a6 as Ce,am as ge,ad as we}from"./index-QOySC_5N.js";import{s as fe}from"./index-D4WfF60I.js";import{u as ve}from"./useArticles-NJw4-Fx8.js";import"./articles-aP_knVEN.js";const ye={class:"full-article-card"},be={class:"article-card-header"},$e=["src","alt"],Me={key:1,class:"avatar-placeholder"},Re={class:"nickname"},Le={class:"publication-time"},je={class:"article-card-content"},xe={class:"article-card-content-title"},Be={class:"metadata-panel"},Te={class:"metadata-text"},Ae={class:"tags-container"},Ie={class:"article-card-preview"},He=["src","alt"],De={key:1,class:"preview-content"},Ve=["innerHTML"],_e={class:"article-card-footer"},Se={class:"article-actions"},Ue={class:"action-group"},Ee=["fill"],Ze={class:"action-count"},Oe=["fill"],Pe={class:"action-count"},Ne=["fill"],ze={class:"action-count"},Fe=["fill"],Ge=["fill"],Ke=["fill"],We=["fill"],qe=K({__name:"FullArticleCard",props:{article:{}},emits:["tagClick","authorClick","articleClick"],setup(_,{emit:S}){const l=_,{react:c}=ve(),s=u(l.article.userReaction==="like"),h=u(l.article.userReaction==="dislike"),i=u(l.article.likes||0),v=u(l.article.dislikes||0),y=u(!1),k=u(!1),a=u(!1),w=u(l.article.commentsCount||0);ee(()=>l.article.userReaction,r=>{s.value=r==="like",h.value=r==="dislike"}),ee(()=>l.article.likes,r=>{i.value=r??i.value}),ee(()=>l.article.dislikes,r=>{v.value=r??v.value});const b=async()=>{try{const r=await c(l.article.id,"like");i.value=r.likes??0,v.value=r.dislikes??0,s.value=r.userReaction==="like",h.value=r.userReaction==="dislike"}catch(r){console.error("Ошибка лайка:",r)}},A=async()=>{try{const r=await c(l.article.id,"dislike");i.value=r.likes??0,v.value=r.dislikes??0,s.value=r.userReaction==="like",h.value=r.userReaction==="dislike"}catch(r){console.error("Ошибка дизлайка:",r)}},M=["success","info","warning","danger","secondary"],L={success:["JavaScript","Vue.js","React","Node.js","Web Development","Frontend","Tutorial","Guide"],info:["Python","TypeScript","Angular","Programming","Backend","Database","SQL","API","REST"],warning:["Design","UI/UX","Mobile Development","Game Development","Unity","Unreal Engine","Review","Interview"],danger:["Security","Testing","Cryptography","DevOps","Docker","Kubernetes","Blockchain"],secondary:["Tools","Git","NoSQL","Fullstack","Artificial Intelligence","Machine Learning","GraphQL","Microservices","Cloud","AWS","Azure","Google Cloud","Linux","Windows","macOS","News","Case Study","Architecture","Algorithms","Design Patterns"]},I=r=>{if(typeof r=="number")return M[r%M.length];const C=r;if(L.success.includes(C))return"success";if(L.info.includes(C))return"info";if(L.warning.includes(C))return"warning";if(L.danger.includes(C))return"danger";if(L.secondary.includes(C))return"secondary";let j=0;for(let R=0;R<C.length;R++)j=C.charCodeAt(R)+((j<<5)-j);const V=Math.abs(j)%M.length;return M[V]},F=()=>{},D=r=>{},U=()=>{},E=()=>{},N=()=>{},z=r=>{const C=typeof r=="string"?new Date(r):r,V=new Date().getTime()-C.getTime(),R=Math.floor(V/(1e3*60*60*24));return R===0?"Today":R===1?"Yesterday":R<7?`${R} days ago`:R<30?`${Math.floor(R/7)} weeks ago`:C.toLocaleDateString("en-US",{day:"numeric",month:"short",year:"numeric"})},Z=r=>{switch(r){case"easy":return"Easy";case"medium":return"Medium";case"hard":return"Hard";default:return"Medium"}};return(r,C)=>(d(),p("div",ye,[e("div",be,[e("div",{class:"logo",onClick:T(E,["stop"])},[r.article.author.avatar?(d(),p("img",{key:0,src:r.article.author.avatar,alt:r.article.author.username,class:"avatar-image"},null,8,$e)):(d(),p("div",Me,[...C[0]||(C[0]=[e("svg",{class:"question-icon",width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),e("path",{d:"M9.09 9C9.3251 8.33167 9.78915 7.76811 10.4 7.40913C11.0108 7.05016 11.7289 6.91894 12.4272 7.03871C13.1255 7.15849 13.7588 7.52152 14.2151 8.06353C14.6713 8.60553 14.9211 9.29152 14.92 10C14.92 12 11.92 13 11.92 13",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),e("path",{d:"M12 17H12.01",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])]))]),e("div",{class:"nickname-container",onClick:T(E,["stop"])},[e("h2",Re,g(r.article.author.username),1),e("h2",Le,g(z(r.article.createdAt)),1)])]),e("div",je,[e("h1",xe,g(r.article.title),1),e("div",Be,[e("div",{class:f(["metadata-item difficulty",`difficulty-${r.article.difficulty||"medium"}`])},[C[1]||(C[1]=e("svg",{class:"metadata-icon",width:"16",height:"16",viewBox:"0 0 512 512",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:`M2230 5098 c-58 -40 -70 -65 -86 -189 -46 -351 -187 -668 -418 -931
                    -90 -104 -165 -169 -352 -308 -498 -373 -786 -889 -835 -1498 -40 -491 129
                    -1027 448 -1422 86 -106 251 -264 363 -347 409 -302 905 -441 1401 -393 535
                    52 1019 309 1367 725 333 398 504 928 463 1433 -38 476 -207 872 -523 1224
                    -97 107 -127 128 -189 128 -70 0 -102 -28 -179 -156 -63 -106 -176 -259 -217
                    -296 -19 -17 -19 -16 -10 60 13 111 2 368 -22 502 -72 411 -254 775 -536 1068
                    -124 129 -212 204 -341 290 -197 131 -268 155 -334 110z m321 -474 c251 -209
                    445 -504 543 -826 56 -186 70 -288 70 -498 0 -209 -13 -298 -71 -493 -48 -161
                    -51 -193 -21 -236 60 -88 138 -100 235 -36 186 122 386 311 513 482 58 79 78
                    99 88 91 25 -22 154 -222 196 -307 242 -483 243 -1058 3 -1538 -141 -280 -336
                    -501 -595 -674 -373 -250 -846 -343 -1284 -255 -622 126 -1113 562 -1308 1162
                    -180 553 -76 1138 285 1599 91 116 231 247 391 366 151 112 311 261 407 379
                    171 212 322 504 382 740 9 36 21 82 26 103 l10 39 27 -18 c15 -9 61 -45 103
                    -80z`})],-1)),e("span",Te,g(Z(r.article.difficulty)),1)],2),C[2]||(C[2]=ie('<div class="metadata-item time" data-v-d525f713><i class="pi pi-clock metadata-icon" data-v-d525f713></i><span class="metadata-text" data-v-d525f713>22 min</span></div><div class="metadata-item views" data-v-d525f713><i class="pi pi-eye metadata-icon" data-v-d525f713></i><span class="metadata-text" data-v-d525f713>3</span></div>',2))]),e("div",Ae,[(d(!0),p(X,null,Y(r.article.tags,j=>(d(),G(ke(fe),{key:j,value:j,severity:I(j),class:"custom-tag",onClick:T(V=>D(),["stop"])},null,8,["value","severity","onClick"]))),128))]),e("div",Ie,[r.article.previewImage?(d(),p("div",{key:0,class:"preview-image",style:re({"--preview-bg":`url(${r.article.previewImage})`})},[e("img",{src:r.article.previewImage,alt:r.article.title,class:"preview-img"},null,8,He)],4)):(d(),p("div",De,[...C[3]||(C[3]=[e("div",{class:"preview-placeholder"},[e("i",{class:"pi pi-image preview-icon"}),e("span",{class:"preview-text"},"Превью статьи")],-1)])]))]),e("div",{class:"article-card-content-text full-content",innerHTML:r.article.content},null,8,Ve)]),e("div",_e,[e("div",Se,[e("div",Ue,[e("button",{class:f(["action-btn like-btn",{active:s.value}]),onClick:T(b,["stop"])},[(d(),p("svg",{class:f(["heart-icon",{filled:s.value}]),width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:s.value?"currentColor":"none"},null,8,Ee)],2)),e("span",Ze,g(i.value),1)],2),e("button",{class:f(["action-btn dislike-btn",{active:h.value}]),onClick:T(A,["stop"])},[(d(),p("svg",{class:f(["dislike-icon",{filled:h.value}]),width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M10 15v4a3 3 0 0 0 3 3l4-9V2H5.72a2 2 0 0 0-2 1.7l-1.38 9a2 2 0 0 0 2 2.3zm7-13h2.67A2.31 2.31 0 0 1 22 4v7a2.31 2.31 0 0 1-2.33 2H17",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:h.value?"currentColor":"none"},null,8,Oe)],2)),e("span",Pe,g(v.value),1)],2),e("button",{class:f(["action-btn comment-btn",{active:k.value}]),onClick:T(U,["stop"])},[(d(),p("svg",{class:f(["comment-icon",{filled:k.value}]),width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:k.value?"currentColor":"none"},null,8,Ne)],2)),e("span",ze,g(w.value),1)],2),e("button",{class:f(["action-btn bookmark-btn",{active:y.value}]),onClick:T(N,["stop"])},[(d(),p("svg",{class:f(["bookmark-icon",{filled:y.value}]),width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:y.value?"currentColor":"none"},null,8,Fe)],2))],2),e("button",{class:f(["action-btn share-btn",{active:a.value}]),onClick:T(F,["stop"])},[(d(),p("svg",{class:f(["share-icon",{filled:a.value}]),width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("circle",{cx:"18",cy:"5",r:"3",stroke:"currentColor","stroke-width":"2",fill:a.value?"currentColor":"none"},null,8,Ge),e("circle",{cx:"6",cy:"12",r:"3",stroke:"currentColor","stroke-width":"2",fill:a.value?"currentColor":"none"},null,8,Ke),e("circle",{cx:"18",cy:"19",r:"3",stroke:"currentColor","stroke-width":"2",fill:a.value?"currentColor":"none"},null,8,We),C[4]||(C[4]=e("path",{d:"m8.59 13.51 6.83 3.98",stroke:"currentColor","stroke-width":"2"},null,-1)),C[5]||(C[5]=e("path",{d:"m15.41 6.51-6.82 3.98",stroke:"currentColor","stroke-width":"2"},null,-1))],2))],2)])])])]))}}),Qe=W(qe,[["__scopeId","data-v-d525f713"]]),Je={class:"comment-header"},Xe=["src","alt"],Ye={key:1,class:"avatar-placeholder"},et={class:"user-info"},tt={class:"user-name-row"},ot={class:"comment-time"},nt={class:"more-options-wrapper"},st={class:"comment-content"},lt=["innerHTML"],it={class:"comment-actions"},rt={key:0,class:"rating-tooltip"},at={class:"tooltip-row likes"},dt={class:"tooltip-row dislikes"},ut={class:"report-panel-content"},ct={class:"report-reasons"},pt=["value"],mt={class:"reason-title"},vt={class:"report-panel-buttons"},kt=["disabled"],ht=K({__name:"CommentBlock",props:{comment:{},highlighted:{type:Boolean},depth:{}},emits:["like","react","reply","userClick","mentionClick"],setup(_,{emit:S}){const l=_,c=S;u(l.comment.userLiked||!1),u(l.comment.likes||0);const s=u(!1),h=u(!1),i=u(!1),v=u(!1),y=u(!1),k=u([]),a=u(null),w=u(l.comment.likes||0),b=u(l.comment.dislikes||0),A=J(()=>w.value-b.value),M=u(!1),L=J(()=>l.comment.text.replace(/@([a-zA-Zа-яА-ЯёЁ0-9_]+)/g,'<span class="mention" style="color: #8c00ff; font-weight: 600; cursor: pointer;" data-mention="$1">@$1</span>')),I=o=>{const t=o.target;t.classList.contains("mention")&&(t.getAttribute("data-mention"),o.stopPropagation())},F=[{id:"spam",title:"Spam",description:"Unwanted commercial content or repetitive messages"},{id:"harassment",title:"Harassment",description:"Bullying, threats, or personal attacks"},{id:"hate",title:"Hate Speech",description:"Content promoting violence or hatred"},{id:"inappropriate",title:"Inappropriate Content",description:"Sexual, violent, or disturbing content"},{id:"misinformation",title:"Misinformation",description:"False or misleading information"}],D=()=>{c("reply",l.comment.id)},U=()=>{c("userClick",l.comment.author.id)},E=()=>{i.value=!i.value},N=()=>{console.log("Edit comment:",l.comment.id),i.value=!1},z=()=>{i.value=!1,v.value=!0},Z=()=>{v.value=!1},r=()=>{console.log("Delete comment:",l.comment.id),v.value=!1},C=()=>{i.value=!1,y.value=!0,k.value=[]},j=()=>{y.value=!1,k.value=[]},V=()=>{console.log("Report comment:",l.comment.id,"Reasons:",k.value),y.value=!1,k.value=[]},R=o=>{const t=o==="up"?"like":"dislike";c("react",l.comment.id,t),a.value===o?(o==="up"?w.value--:b.value--,a.value=null):a.value?(a.value==="up"?(w.value--,b.value++):(b.value--,w.value++),a.value=o):(o==="up"?w.value++:b.value++,a.value=o),console.log("Vote:",o,"Rating:",A.value)},q=o=>{const t=typeof o=="string"?new Date(o):o,m=new Date().getTime()-t.getTime(),x=Math.floor(m/(1e3*60)),$=Math.floor(m/(1e3*60*60)),B=Math.floor(m/(1e3*60*60*24));return x<1?"just now":x<60?`${x} min ago`:$<24?`${$} h ago`:B===1?"yesterday":B<7?`${B} days ago`:t.toLocaleDateString("ru-RU",{day:"numeric",month:"short",year:"numeric"})},O=o=>{!o.target.closest(".more-options-wrapper")&&i.value&&(i.value=!1)};return se(()=>{document.addEventListener("click",O)}),ae(()=>{document.removeEventListener("click",O)}),(o,t)=>(d(),p("div",{class:f(["comment-block",{highlighted:o.highlighted}]),style:re({marginLeft:`${(o.depth||0)*40}px`})},[e("div",Je,[e("div",{class:"user-avatar",onClick:U},[o.comment.author.avatar?(d(),p("img",{key:0,src:o.comment.author.avatar,alt:o.comment.author.username,class:"avatar-image"},null,8,Xe)):(d(),p("div",Ye,[...t[12]||(t[12]=[e("svg",{class:"question-icon",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),e("path",{d:"M9.09 9C9.3251 8.33167 9.78915 7.76811 10.4 7.40913C11.0108 7.05016 11.7289 6.91894 12.4272 7.03871C13.1255 7.15849 13.7588 7.52152 14.2151 8.06353C14.6713 8.60553 14.9211 9.29152 14.92 10C14.92 12 11.92 13 11.92 13",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),e("path",{d:"M12 17H12.01",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])]))]),e("div",et,[e("div",tt,[e("h3",{class:"username",onClick:U},g(o.comment.author.username),1),e("span",ot,g(q(o.comment.createdAt)),1),e("div",nt,[(d(),p("svg",{width:"24",height:"24",viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",class:f(["more-options-icon",{active:i.value}]),onClick:E},[...t[13]||(t[13]=[e("path",{d:"M24 26C25.1046 26 26 25.1046 26 24C26 22.8954 25.1046 22 24 22C22.8954 22 22 22.8954 22 24C22 25.1046 22.8954 26 24 26Z",stroke:"currentColor","stroke-width":"4","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),e("path",{d:"M24 12C25.1046 12 26 11.1046 26 10C26 8.89543 25.1046 8 24 8C22.8954 8 22 8.89543 22 10C22 11.1046 22.8954 12 24 12Z",stroke:"currentColor","stroke-width":"4","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),e("path",{d:"M24 40C25.1046 40 26 39.1046 26 38C26 36.8954 25.1046 36 24 36C22.8954 36 22 36.8954 22 38C22 39.1046 22.8954 40 24 40Z",stroke:"currentColor","stroke-width":"4","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])],2)),P(oe,{name:"dropdown-fade"},{default:te(()=>[i.value?(d(),p("div",{key:0,class:"options-dropdown",onClick:t[0]||(t[0]=T(()=>{},["stop"]))},[e("button",{class:"dropdown-item",onClick:N},[...t[14]||(t[14]=[e("svg",{width:"23",height:"23",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M11 4H4C3.46957 4 2.96086 4.21071 2.58579 4.58579C2.21071 4.96086 2 5.46957 2 6V20C2 20.5304 2.21071 21.0391 2.58579 21.4142C2.96086 21.7893 3.46957 22 4 22H18C18.5304 22 19.0391 21.7893 19.4142 21.4142C19.7893 21.0391 20 20.5304 20 20V13",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),e("path",{d:"M18.5 2.5C18.8978 2.10217 19.4374 1.87868 20 1.87868C20.5626 1.87868 21.1022 2.10217 21.5 2.5C21.8978 2.89783 22.1213 3.43739 22.1213 4C22.1213 4.56261 21.8978 5.10217 21.5 5.5L12 15L8 16L9 12L18.5 2.5Z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),e("span",null,"Edit",-1)])]),e("button",{class:"dropdown-item danger",onClick:z},[...t[15]||(t[15]=[e("svg",{width:"23",height:"23",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M3 6H5H21",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),e("path",{d:"M8 6V4C8 3.46957 8.21071 2.96086 8.58579 2.58579C8.96086 2.21071 9.46957 2 10 2H14C14.5304 2 15.0391 2.21071 15.4142 2.58579C15.7893 2.96086 16 3.46957 16 4V6M19 6V20C19 20.5304 18.7893 21.0391 18.4142 21.4142C18.0391 21.7893 17.5304 22 17 22H7C6.46957 22 5.96086 21.7893 5.58579 21.4142C5.21071 21.0391 5 20.5304 5 20V6H19Z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),e("span",null,"Delete",-1)])]),e("button",{class:"dropdown-item",onClick:C},[...t[16]||(t[16]=[e("svg",{width:"23",height:"23",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M10.29 3.86L1.82 18C1.64537 18.3024 1.55296 18.6453 1.55199 18.9945C1.55101 19.3437 1.64151 19.6871 1.81445 19.9905C1.98738 20.2939 2.23675 20.5467 2.53773 20.7239C2.83871 20.901 3.18082 20.9962 3.53 21H20.47C20.8192 20.9962 21.1613 20.901 21.4623 20.7239C21.7633 20.5467 22.0126 20.2939 22.1856 19.9905C22.3585 19.6871 22.449 19.3437 22.448 18.9945C22.447 18.6453 22.3546 18.3024 22.18 18L13.71 3.86C13.5317 3.56611 13.2807 3.32312 12.9812 3.15448C12.6817 2.98585 12.3437 2.89725 12 2.89725C11.6563 2.89725 11.3183 2.98585 11.0188 3.15448C10.7193 3.32312 10.4683 3.56611 10.29 3.86V3.86Z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),e("path",{d:"M12 9V13",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),e("path",{d:"M12 17H12.01",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),e("span",null,"Report",-1)])])])):H("",!0)]),_:1})])])])]),e("div",st,[e("p",{class:"comment-text",innerHTML:L.value,onClick:I},null,8,lt)]),e("div",it,[e("button",{class:"action-btn reply-btn",onClick:D},[...t[17]||(t[17]=[e("svg",{class:"reply-icon",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M9 14L4 9L9 4",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),e("path",{d:"M20 20V13C20 11.9391 19.5786 10.9217 18.8284 10.1716C18.0783 9.42143 17.0609 9 16 9H4",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),e("span",{class:"action-text"},"Reply",-1)])]),e("div",{class:"rating-system",onMouseenter:t[7]||(t[7]=n=>M.value=!0),onMouseleave:t[8]||(t[8]=n=>M.value=!1)},[e("div",{class:f(["dropdown-icon1",{active:a.value==="up"}]),onClick:t[1]||(t[1]=n=>R("up")),onMouseenter:t[2]||(t[2]=n=>s.value=!0),onMouseleave:t[3]||(t[3]=n=>s.value=!1)},[P(ne,{color:a.value==="up"||s.value?"#22c55e":"#9BA4AE"},null,8,["color"])],34),e("p",{class:f(["rating-text",{positive:A.value>0,negative:A.value<0}])},g(A.value),3),e("div",{class:f(["dropdown-icon2",{active:a.value==="down"}]),onClick:t[4]||(t[4]=n=>R("down")),onMouseenter:t[5]||(t[5]=n=>h.value=!0),onMouseleave:t[6]||(t[6]=n=>h.value=!1)},[P(ne,{color:a.value==="down"||h.value?"#ef4444":"#9BA4AE"},null,8,["color"])],34),P(oe,{name:"tooltip-fade"},{default:te(()=>[M.value?(d(),p("div",rt,[e("div",at,[t[18]||(t[18]=e("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M7 11L12 6L17 11M12 18V7",stroke:"#22c55e","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),e("span",null,g(w.value),1)]),e("div",dt,[t[19]||(t[19]=e("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M17 13L12 18L7 13M12 6V17",stroke:"#ef4444","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),e("span",null,g(b.value),1)])])):H("",!0)]),_:1})],32)]),v.value?(d(),p("div",{key:0,class:"delete-panel-overlay",onClick:Z},[e("div",{class:"delete-panel",onClick:t[9]||(t[9]=T(()=>{},["stop"]))},[e("div",{class:"delete-panel-content"},[t[20]||(t[20]=e("p",{class:"delete-panel-text"},"Are you sure you want to delete this comment?",-1)),e("div",{class:"delete-panel-buttons"},[e("button",{class:"delete-panel-button cancel",onClick:Z},"Cancel"),e("button",{class:"delete-panel-button confirm",onClick:r},"Delete")])])])])):H("",!0),y.value?(d(),p("div",{key:1,class:"report-panel-overlay",onClick:j},[e("div",{class:"report-panel",onClick:t[11]||(t[11]=T(()=>{},["stop"]))},[e("div",ut,[t[22]||(t[22]=e("h3",{class:"report-panel-title"},"Report Comment",-1)),t[23]||(t[23]=e("p",{class:"report-panel-subtitle"},"Select the reason for reporting:",-1)),e("div",ct,[(d(),p(X,null,Y(F,n=>e("label",{key:n.id,class:f(["reason-item",{selected:k.value.includes(n.id)}])},[le(e("input",{type:"checkbox",value:n.id,"onUpdate:modelValue":t[10]||(t[10]=m=>k.value=m),class:"reason-checkbox"},null,8,pt),[[de,k.value]]),t[21]||(t[21]=e("span",{class:"reason-checkmark"},null,-1)),e("span",mt,g(n.title),1)],2)),64))]),e("div",vt,[e("button",{class:"report-panel-button cancel",onClick:j},"Cancel"),e("button",{class:"report-panel-button confirm",onClick:V,disabled:k.value.length===0}," Submit Report ",8,kt)])])])])):H("",!0)],6))}}),Ct=W(ht,[["__scopeId","data-v-f00abc2e"]]),gt={class:"comment-header"},wt=["src","alt"],ft={key:1,class:"avatar-placeholder"},yt={class:"user-info"},bt={class:"user-name-row"},$t={class:"username-with-badge"},Mt={class:"comment-time"},Rt={class:"more-options-wrapper"},Lt={class:"comment-content"},jt=["innerHTML"],xt={class:"comment-actions"},Bt={key:0,class:"rating-tooltip"},Tt={class:"tooltip-row likes"},At={class:"tooltip-row dislikes"},It={class:"report-panel-content"},Ht={class:"report-reasons"},Dt=["value"],Vt={class:"reason-title"},_t={class:"report-panel-buttons"},St=["disabled"],Ut=K({__name:"AuthorCommentBlock",props:{comment:{},highlighted:{type:Boolean},depth:{}},emits:["like","react","reply","userClick","mentionClick"],setup(_,{emit:S}){const l=_,c=S;u(l.comment.userLiked||!1),u(l.comment.likes||0);const s=u(!1),h=u(!1),i=u(!1),v=u(!1),y=u(!1),k=u([]),a=u(null),w=u(l.comment.likes||0),b=u(l.comment.dislikes||0),A=J(()=>w.value-b.value),M=u(!1),L=J(()=>l.comment.text.replace(/@([a-zA-Zа-яА-ЯёЁ0-9_]+)/g,'<span class="mention" style="color: #8c00ff; font-weight: 600; cursor: pointer;" data-mention="$1">@$1</span>')),I=o=>{const t=o.target;t.classList.contains("mention")&&(t.getAttribute("data-mention"),o.stopPropagation())},F=[{id:"spam",title:"Spam",description:"Unwanted commercial content or repetitive messages"},{id:"harassment",title:"Harassment",description:"Bullying, threats, or personal attacks"},{id:"hate",title:"Hate Speech",description:"Content promoting violence or hatred"},{id:"inappropriate",title:"Inappropriate Content",description:"Sexual, violent, or disturbing content"},{id:"misinformation",title:"Misinformation",description:"False or misleading information"}],D=()=>{c("reply",l.comment.id)},U=()=>{c("userClick",l.comment.author.id)},E=()=>{i.value=!i.value},N=()=>{console.log("Edit comment:",l.comment.id),i.value=!1},z=()=>{i.value=!1,v.value=!0},Z=()=>{v.value=!1},r=()=>{console.log("Delete comment:",l.comment.id),v.value=!1},C=()=>{i.value=!1,y.value=!0,k.value=[]},j=()=>{y.value=!1,k.value=[]},V=()=>{console.log("Report comment:",l.comment.id,"Reasons:",k.value),y.value=!1,k.value=[]},R=o=>{const t=o==="up"?"like":"dislike";c("react",l.comment.id,t),a.value===o?(o==="up"?w.value--:b.value--,a.value=null):a.value?(a.value==="up"?(w.value--,b.value++):(b.value--,w.value++),a.value=o):(o==="up"?w.value++:b.value++,a.value=o)},q=o=>{const t=typeof o=="string"?new Date(o):o,m=new Date().getTime()-t.getTime(),x=Math.floor(m/(1e3*60)),$=Math.floor(m/(1e3*60*60)),B=Math.floor(m/(1e3*60*60*24));return x<1?"just now":x<60?`${x} min ago`:$<24?`${$} h ago`:B===1?"yesterday":B<7?`${B} days ago`:t.toLocaleDateString("ru-RU",{day:"numeric",month:"short",year:"numeric"})},O=o=>{!o.target.closest(".more-options-wrapper")&&i.value&&(i.value=!1)};return se(()=>{document.addEventListener("click",O)}),ae(()=>{document.removeEventListener("click",O)}),(o,t)=>(d(),p("div",{class:f(["author-comment-block",{highlighted:o.highlighted}]),style:re({marginLeft:`${(o.depth||0)*40}px`})},[e("div",gt,[e("div",{class:"user-avatar author-avatar",onClick:U},[o.comment.author.avatar?(d(),p("img",{key:0,src:o.comment.author.avatar,alt:o.comment.author.username,class:"avatar-image"},null,8,wt)):(d(),p("div",ft,[...t[12]||(t[12]=[e("svg",{class:"question-icon",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),e("path",{d:"M9.09 9C9.3251 8.33167 9.78915 7.76811 10.4 7.40913C11.0108 7.05016 11.7289 6.91894 12.4272 7.03871C13.1255 7.15849 13.7588 7.52152 14.2151 8.06353C14.6713 8.60553 14.9211 9.29152 14.92 10C14.92 12 11.92 13 11.92 13",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),e("path",{d:"M12 17H12.01",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])]))]),e("div",yt,[e("div",bt,[e("div",$t,[e("h3",{class:"username author-username",onClick:U},g(o.comment.author.username),1),t[13]||(t[13]=e("span",{class:"author-badge"},[e("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z",fill:"currentColor"})]),ue(" Author ")],-1))]),e("span",Mt,g(q(o.comment.createdAt)),1),e("div",Rt,[(d(),p("svg",{width:"24",height:"24",viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",class:f(["more-options-icon",{active:i.value}]),onClick:E},[...t[14]||(t[14]=[e("path",{d:"M24 26C25.1046 26 26 25.1046 26 24C26 22.8954 25.1046 22 24 22C22.8954 22 22 22.8954 22 24C22 25.1046 22.8954 26 24 26Z",stroke:"currentColor","stroke-width":"4","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),e("path",{d:"M24 12C25.1046 12 26 11.1046 26 10C26 8.89543 25.1046 8 24 8C22.8954 8 22 8.89543 22 10C22 11.1046 22.8954 12 24 12Z",stroke:"currentColor","stroke-width":"4","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),e("path",{d:"M24 40C25.1046 40 26 39.1046 26 38C26 36.8954 25.1046 36 24 36C22.8954 36 22 36.8954 22 38C22 39.1046 22.8954 40 24 40Z",stroke:"currentColor","stroke-width":"4","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])],2)),P(oe,{name:"dropdown-fade"},{default:te(()=>[i.value?(d(),p("div",{key:0,class:"options-dropdown",onClick:t[0]||(t[0]=T(()=>{},["stop"]))},[e("button",{class:"dropdown-item",onClick:N},[...t[15]||(t[15]=[e("svg",{width:"23",height:"23",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M11 4H4C3.46957 4 2.96086 4.21071 2.58579 4.58579C2.21071 4.96086 2 5.46957 2 6V20C2 20.5304 2.21071 21.0391 2.58579 21.4142C2.96086 21.7893 3.46957 22 4 22H18C18.5304 22 19.0391 21.7893 19.4142 21.4142C19.7893 21.0391 20 20.5304 20 20V13",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),e("path",{d:"M18.5 2.5C18.8978 2.10217 19.4374 1.87868 20 1.87868C20.5626 1.87868 21.1022 2.10217 21.5 2.5C21.8978 2.89783 22.1213 3.43739 22.1213 4C22.1213 4.56261 21.8978 5.10217 21.5 5.5L12 15L8 16L9 12L18.5 2.5Z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),e("span",null,"Edit",-1)])]),e("button",{class:"dropdown-item danger",onClick:z},[...t[16]||(t[16]=[e("svg",{width:"23",height:"23",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M3 6H5H21",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),e("path",{d:"M8 6V4C8 3.46957 8.21071 2.96086 8.58579 2.58579C8.96086 2.21071 9.46957 2 10 2H14C14.5304 2 15.0391 2.21071 15.4142 2.58579C15.7893 2.96086 16 3.46957 16 4V6M19 6V20C19 20.5304 18.7893 21.0391 18.4142 21.4142C18.0391 21.7893 17.5304 22 17 22H7C6.46957 22 5.96086 21.7893 5.58579 21.4142C5.21071 21.0391 5 20.5304 5 20V6H19Z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),e("span",null,"Delete",-1)])]),e("button",{class:"dropdown-item",onClick:C},[...t[17]||(t[17]=[e("svg",{width:"23",height:"23",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M10.29 3.86L1.82 18C1.64537 18.3024 1.55296 18.6453 1.55199 18.9945C1.55101 19.3437 1.64151 19.6871 1.81445 19.9905C1.98738 20.2939 2.23675 20.5467 2.53773 20.7239C2.83871 20.901 3.18082 20.9962 3.53 21H20.47C20.8192 20.9962 21.1613 20.901 21.4623 20.7239C21.7633 20.5467 22.0126 20.2939 22.1856 19.9905C22.3585 19.6871 22.449 19.3437 22.448 18.9945C22.447 18.6453 22.3546 18.3024 22.18 18L13.71 3.86C13.5317 3.56611 13.2807 3.32312 12.9812 3.15448C12.6817 2.98585 12.3437 2.89725 12 2.89725C11.6563 2.89725 11.3183 2.98585 11.0188 3.15448C10.7193 3.32312 10.4683 3.56611 10.29 3.86V3.86Z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),e("path",{d:"M12 9V13",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),e("path",{d:"M12 17H12.01",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),e("span",null,"Report",-1)])])])):H("",!0)]),_:1})])])])]),e("div",Lt,[e("p",{class:"comment-text",innerHTML:L.value,onClick:I},null,8,jt)]),e("div",xt,[e("button",{class:"action-btn reply-btn",onClick:D},[...t[18]||(t[18]=[e("svg",{class:"reply-icon",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M9 14L4 9L9 4",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),e("path",{d:"M20 20V13C20 11.9391 19.5786 10.9217 18.8284 10.1716C18.0783 9.42143 17.0609 9 16 9H4",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),e("span",{class:"action-text"},"Reply",-1)])]),e("div",{class:"rating-system",onMouseenter:t[7]||(t[7]=n=>M.value=!0),onMouseleave:t[8]||(t[8]=n=>M.value=!1)},[e("div",{class:f(["dropdown-icon1",{active:a.value==="up"}]),onClick:t[1]||(t[1]=n=>R("up")),onMouseenter:t[2]||(t[2]=n=>s.value=!0),onMouseleave:t[3]||(t[3]=n=>s.value=!1)},[P(ne,{color:a.value==="up"||s.value?"#22c55e":"#9BA4AE"},null,8,["color"])],34),e("p",{class:f(["rating-text",{positive:A.value>0,negative:A.value<0}])},g(A.value),3),e("div",{class:f(["dropdown-icon2",{active:a.value==="down"}]),onClick:t[4]||(t[4]=n=>R("down")),onMouseenter:t[5]||(t[5]=n=>h.value=!0),onMouseleave:t[6]||(t[6]=n=>h.value=!1)},[P(ne,{color:a.value==="down"||h.value?"#ef4444":"#9BA4AE"},null,8,["color"])],34),P(oe,{name:"tooltip-fade"},{default:te(()=>[M.value?(d(),p("div",Bt,[e("div",Tt,[t[19]||(t[19]=e("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M7 11L12 6L17 11M12 18V7",stroke:"#22c55e","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),e("span",null,g(w.value),1)]),e("div",At,[t[20]||(t[20]=e("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M17 13L12 18L7 13M12 6V17",stroke:"#ef4444","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),e("span",null,g(b.value),1)])])):H("",!0)]),_:1})],32)]),v.value?(d(),p("div",{key:0,class:"delete-panel-overlay",onClick:Z},[e("div",{class:"delete-panel",onClick:t[9]||(t[9]=T(()=>{},["stop"]))},[e("div",{class:"delete-panel-content"},[t[21]||(t[21]=e("p",{class:"delete-panel-text"},"Are you sure you want to delete this comment?",-1)),e("div",{class:"delete-panel-buttons"},[e("button",{class:"delete-panel-button cancel",onClick:Z},"Cancel"),e("button",{class:"delete-panel-button confirm",onClick:r},"Delete")])])])])):H("",!0),y.value?(d(),p("div",{key:1,class:"report-panel-overlay",onClick:j},[e("div",{class:"report-panel",onClick:t[11]||(t[11]=T(()=>{},["stop"]))},[e("div",It,[t[23]||(t[23]=e("h3",{class:"report-panel-title"},"Report Comment",-1)),t[24]||(t[24]=e("p",{class:"report-panel-subtitle"},"Select the reason for reporting:",-1)),e("div",Ht,[(d(),p(X,null,Y(F,n=>e("label",{key:n.id,class:f(["reason-item",{selected:k.value.includes(n.id)}])},[le(e("input",{type:"checkbox",value:n.id,"onUpdate:modelValue":t[10]||(t[10]=m=>k.value=m),class:"reason-checkbox"},null,8,Dt),[[de,k.value]]),t[22]||(t[22]=e("span",{class:"reason-checkmark"},null,-1)),e("span",Vt,g(n.title),1)],2)),64))]),e("div",_t,[e("button",{class:"report-panel-button cancel",onClick:j},"Cancel"),e("button",{class:"report-panel-button confirm",onClick:V,disabled:k.value.length===0}," Submit Report ",8,St)])])])])):H("",!0)],6))}}),Et=W(Ut,[["__scopeId","data-v-c84a1de4"]]),Zt={key:0,class:"reply-indicator"},Ot={class:"reply-to-text"},Pt={class:"reply-username"},Nt={class:"comment-input-container"},zt=["placeholder","rows","onKeydown"],Ft=["disabled"],Gt=K({__name:"CommentInput",props:{isReply:{type:Boolean,default:!1},replyToUser:{},replyToId:{},placeholder:{default:"Write a comment..."},rows:{default:3},submitButtonText:{default:"Submit"}},emits:["submit","cancel"],setup(_,{emit:S}){const l=_,c=S,s=u(""),h=u(null);ee(()=>l.replyToUser,k=>{k&&!s.value.startsWith(`@${k}`)&&(s.value=`@${k}, `,me(()=>{if(h.value){h.value.focus();const a=s.value.length;h.value.setSelectionRange(a,a)}}))},{immediate:!0});const i=()=>{s.value.trim()&&(c("submit",{text:s.value.trim(),replyToId:l.replyToId,replyToUser:l.replyToUser}),s.value="")},v=()=>{s.value="",c("cancel")},y=()=>{h.value&&(h.value.style.height="auto",h.value.style.height=h.value.scrollHeight+"px")};return se(()=>{l.isReply&&h.value&&h.value.focus()}),(k,a)=>(d(),p("div",{class:f(["comment-input-wrapper",{"reply-input":k.isReply}])},[k.replyToUser?(d(),p("div",Zt,[a[3]||(a[3]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M9 14L4 9L9 4",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),e("path",{d:"M20 20V13C20 11.9391 19.5786 10.9217 18.8284 10.1716C18.0783 9.42143 17.0609 9 16 9H4",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),e("span",Ot,[a[1]||(a[1]=ue("Replying to ",-1)),e("span",Pt,"@"+g(k.replyToUser),1)]),e("button",{class:"cancel-reply-btn",onClick:v},[...a[2]||(a[2]=[e("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M18 6L6 18M6 6L18 18",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])])])):H("",!0),e("div",Nt,[a[4]||(a[4]=ie('<div class="user-avatar-small" data-v-100494f4><svg class="question-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-100494f4><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-100494f4></path><path d="M9.09 9C9.3251 8.33167 9.78915 7.76811 10.4 7.40913C11.0108 7.05016 11.7289 6.91894 12.4272 7.03871C13.1255 7.15849 13.7588 7.52152 14.2151 8.06353C14.6713 8.60553 14.9211 9.29152 14.92 10C14.92 12 11.92 13 11.92 13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-100494f4></path><path d="M12 17H12.01" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-100494f4></path></svg></div>',1)),le(e("textarea",{ref_key:"textareaRef",ref:h,"onUpdate:modelValue":a[0]||(a[0]=w=>s.value=w),class:"comment-input",placeholder:k.placeholder,rows:k.rows,onKeydown:pe(T(i,["ctrl"]),["enter"]),onInput:y},null,40,zt),[[ce,s.value]]),e("button",{class:"submit-comment-btn",onClick:i,disabled:!s.value.trim()},g(k.submitButtonText),9,Ft)])],2))}}),Kt=W(Gt,[["__scopeId","data-v-100494f4"]]),Wt={class:"comment-thread"},qt={name:"CommentThread"},Qt=K({...qt,props:{comment:{},highlightedCommentId:{},replyingTo:{}},emits:["like","react","reply","userClick","mentionClick","submitReply","cancelReply"],setup(_,{emit:S}){const l=S;return(c,s)=>{const h=he("CommentThread",!0);return d(),p("div",Wt,[c.comment.author.isAuthor?(d(),G(Et,{key:0,id:`comment-${c.comment.id}`,comment:c.comment,depth:c.comment.depth,highlighted:c.highlightedCommentId===c.comment.id,onLike:s[0]||(s[0]=i=>l("like",c.comment.id)),onReact:s[1]||(s[1]=(i,v)=>l("react",i,v)),onReply:s[2]||(s[2]=i=>l("reply",c.comment.id)),onUserClick:s[3]||(s[3]=i=>l("userClick",i)),onMentionClick:s[4]||(s[4]=i=>l("mentionClick",i))},null,8,["id","comment","depth","highlighted"])):(d(),G(Ct,{key:1,id:`comment-${c.comment.id}`,comment:c.comment,depth:c.comment.depth,highlighted:c.highlightedCommentId===c.comment.id,onLike:s[5]||(s[5]=i=>l("like",c.comment.id)),onReact:s[6]||(s[6]=(i,v)=>l("react",i,v)),onReply:s[7]||(s[7]=i=>l("reply",c.comment.id)),onUserClick:s[8]||(s[8]=i=>l("userClick",i)),onMentionClick:s[9]||(s[9]=i=>l("mentionClick",i))},null,8,["id","comment","depth","highlighted"])),c.replyingTo&&c.replyingTo.id===c.comment.id?(d(),G(Kt,{key:2,"is-reply":!0,"reply-to-user":c.replyingTo.username,"reply-to-id":c.replyingTo.id,placeholder:"Write your reply...","submit-button-text":"Reply",onSubmit:s[10]||(s[10]=i=>l("submitReply",i)),onCancel:s[11]||(s[11]=i=>l("cancelReply"))},null,8,["reply-to-user","reply-to-id"])):H("",!0),c.comment.children&&c.comment.children.length>0?(d(!0),p(X,{key:3},Y(c.comment.children,i=>(d(),G(h,{key:i.id,comment:i,"highlighted-comment-id":c.highlightedCommentId,"replying-to":c.replyingTo,onLike:s[12]||(s[12]=v=>l("like",v)),onReact:s[13]||(s[13]=(v,y)=>l("react",v,y)),onReply:s[14]||(s[14]=v=>l("reply",v)),onUserClick:s[15]||(s[15]=v=>l("userClick",v)),onMentionClick:s[16]||(s[16]=v=>l("mentionClick",v)),onSubmitReply:s[17]||(s[17]=v=>l("submitReply",v)),onCancelReply:s[18]||(s[18]=v=>l("cancelReply"))},null,8,["comment","highlighted-comment-id","replying-to"]))),128)):H("",!0)])}}}),Jt=W(Qt,[["__scopeId","data-v-04ad27f5"]]),Xt={class:"full-article-page"},Yt={key:0,class:"loading-container"},eo={class:"loading-text"},to={key:1,class:"error-container"},oo={class:"error-text"},no={class:"error-message"},so={key:2,class:"article-container"},lo={class:"comments-section"},io={class:"comments-title"},ro={class:"comment-input-container"},ao=["onKeydown"],uo=["disabled"],co={class:"comments-list"},po={key:0,class:"no-comments"},mo={key:3,class:"not-found-container"},vo={class:"not-found-text"},ko=K({__name:"FullArticle",setup(_){const{t:S}=Ce(),l=ge(),c=we(),{getArticle:s,fetchComments:h,addComment:i,reactCommentFn:v}=ve(),y=u(null),k=u(!0),a=u(null),w=u(""),b=u(null),A=u(null),M=u([]),L=u([]),I=u([]),F=J(()=>M.value.length+L.value.length),D=u(parseInt(l.params.id)),U=async()=>{try{if(k.value=!0,a.value=null,isNaN(D.value))throw new Error("Invalid article ID");const o=await s(D.value);y.value=o;const n=(await h(D.value)).map(m=>({id:m.id,author:{id:m.author_id??0,username:m.author_name||"Guest",avatar:"",isAuthor:(m.author_name||"")===(o.author?.username||o.author||"")},text:m.text,createdAt:m.created_at,likes:m.likes??0,dislikes:m.dislikes??0,userLiked:m.user_reaction==="like",userReaction:m.user_reaction??null,parentId:m.parent_id??null,replyToCommentId:m.parent_id??null}));M.value=n.filter(m=>!m.parentId),L.value=n.filter(m=>!!m.parentId),I.value=O(n),console.log("Comment tree built:",I.value)}catch(o){console.error("Error loading article:",o),a.value=o instanceof Error?o.message:"Unknown error occurred"}finally{k.value=!1}},E=()=>{c.go(-1)},N=async()=>{if(!w.value.trim())return;const o=await z(w.value);M.value.unshift(o),w.value="";const t=[...M.value,...L.value];I.value=O(t)};async function z(o,t){console.log("Adding comment with parent_id:",t);const n=await i(D.value,o,t??null);return console.log("Comment created from API:",n),{id:n.id,author:{id:n.author_id??0,username:n.author_name||"Guest",avatar:"",isAuthor:(n.author_name||"")===(y.value?.author?.username||y.value?.author||"")},text:n.text,createdAt:n.created_at,likes:n.likes??0,dislikes:n.dislikes??0,userLiked:!1,parentId:n.parent_id??null,replyToCommentId:n.parent_id??null}}const Z=o=>{console.log("Like comment:",o)},r=async(o,t)=>{try{const n=await v(o,t),m=x=>{x.id===o&&(x.likes=n.likes??0,x.dislikes=n.dislikes??0,x.userReaction=n.user_reaction??null,x.userLiked=n.user_reaction==="like")};M.value.forEach(m),L.value.forEach(m)}catch(n){console.error("Error reacting to comment:",n)}},C=o=>{const t=M.value.find(n=>n.id===o)||L.value.find(n=>n.id===o);t&&(b.value={id:o,parentId:o,username:t.author.username})},j=async o=>{if(!b.value)return;const t=await z(o.text,b.value.id);L.value.push(t),b.value=null;const n=[...M.value,...L.value];I.value=O(n)},V=()=>{b.value=null},R=o=>{console.log("User clicked:",o)},q=o=>{A.value=o,me(()=>{const t=document.getElementById(`comment-${o}`);t?(t.scrollIntoView({behavior:"smooth",block:"center"}),setTimeout(()=>{setTimeout(()=>{A.value=null},3e3)},800)):setTimeout(()=>{A.value=null},3e3)})};function O(o,t=0){console.log("Building tree from comments:",o);const n=new Map,m=[],x=[...o].sort(($,B)=>!$.parentId&&B.parentId?-1:$.parentId&&!B.parentId?1:0);return x.forEach($=>{n.set($.id,{...$,depth:t,children:[]})}),x.forEach($=>{const B=n.get($.id);if($.parentId){const Q=n.get($.parentId);console.log(`Comment ${$.id} has parent ${$.parentId}`,Q?"found":"NOT FOUND"),Q?(B.depth=1,Q.children=Q.children||[],Q.children.push(B),console.log(`Added comment ${$.id} as child of ${$.parentId}, depth: ${B.depth}`)):(m.push(B),console.log(`Parent not found for comment ${$.id}, adding as root`))}else m.push(B),console.log(`Comment ${$.id} is a root comment`)}),console.log("Root comments:",m),m}return se(()=>{U()}),(o,t)=>(d(),p("div",Xt,[k.value?(d(),p("div",Yt,[t[1]||(t[1]=e("div",{class:"loading-spinner"},null,-1)),e("p",eo,g(o.$t("common.loading")),1)])):a.value?(d(),p("div",to,[e("h1",oo,g(o.$t("common.error")),1),e("p",no,g(a.value),1),e("button",{onClick:E,class:"back-button"},g(o.$t("common.go_back")),1)])):y.value?(d(),p("div",so,[P(Qe,{article:y.value},null,8,["article"]),e("div",lo,[e("h2",io,"Comments ("+g(F.value)+")",1),e("div",ro,[t[2]||(t[2]=ie('<div class="user-avatar-small" data-v-c3241ce1><svg class="question-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-c3241ce1><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-c3241ce1></path><path d="M9.09 9C9.3251 8.33167 9.78915 7.76811 10.4 7.40913C11.0108 7.05016 11.7289 6.91894 12.4272 7.03871C13.1255 7.15849 13.7588 7.52152 14.2151 8.06353C14.6713 8.60553 14.9211 9.29152 14.92 10C14.92 12 11.92 13 11.92 13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-c3241ce1></path><path d="M12 17H12.01" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-c3241ce1></path></svg></div>',1)),le(e("textarea",{"onUpdate:modelValue":t[0]||(t[0]=n=>w.value=n),class:"comment-input",placeholder:"Write a comment...",rows:"3",onKeydown:pe(T(N,["ctrl"]),["enter"])},null,40,ao),[[ce,w.value]]),e("button",{class:"submit-comment-btn",onClick:N,disabled:!w.value.trim()}," Submit ",8,uo)]),e("div",co,[(d(!0),p(X,null,Y(I.value,n=>(d(),G(Jt,{key:n.id,comment:n,"highlighted-comment-id":A.value,"replying-to":b.value,onLike:Z,onReact:r,onReply:C,onUserClick:R,onMentionClick:q,onSubmitReply:j,onCancelReply:V},null,8,["comment","highlighted-comment-id","replying-to"]))),128)),I.value.length===0?(d(),p("div",po,[...t[3]||(t[3]=[e("p",null,"Be the first to leave a comment!",-1)])])):H("",!0)])])])):(d(),p("div",mo,[e("h1",vo,g(o.$t("common.article_not_found")),1),e("button",{onClick:E,class:"back-button"},g(o.$t("common.go_back")),1)]))]))}}),fo=W(ko,[["__scopeId","data-v-c3241ce1"]]);export{fo as default};
